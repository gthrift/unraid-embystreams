Menu="Dashboard"
Icon="emby.png"
---
<style>
    #emby_streams_content { padding: 0; }
    #emby_streams_content table { width: 100%; border-collapse: collapse; }
    #emby_streams_content th { text-align: left; padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.1); opacity: 0.7; font-size: 0.9em; }
    #emby_streams_content td { padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.05); }
    .es-img { width: 24px; height: 24px; border-radius: 50%; vertical-align: middle; margin-right: 8px; }
</style>

<?php
$cfg = parse_ini_file("/boot/config/plugins/embystreams/embystreams.cfg");
$interval = isset($cfg['POLL_INTERVAL']) ? (int)$cfg['POLL_INTERVAL'] * 1000 : 5000;
?>

<div class="tile" id="emby-streams-tile">
    <div class="tile-header">
        <i class="icon-emby" style="font-size: 20px; vertical-align: middle;"></i>
        <span style="font-weight: 600; padding-left: 5px;">Emby Streams</span>
        <a href="/Settings/EmbyStreamsSettings" title="Configure Emby Streams" style="float:right; opacity:0.5;">
            <i class="fa fa-cog"></i>
        </a>
    </div>
    
    <div class="tile-content" id="emby_streams_content" style="min-height: 80px;">
        <div style="text-align:center; padding: 20px; opacity: 0.6;">
            <i class="fa fa-spinner fa-spin"></i> Loading...
        </div>
    </div>
</div>
<script>
    var embyPollInterval = <?=$interval;?>;
    
    function updateEmbyStreams() {
        $.get("/plugins/embystreams/embystreams_api.php", function(data) {
            if(data.trim() !== "") {
                $("#emby_streams_content").html(data);
            }
        });
    }

    // Refresh automatically
    setInterval(updateEmbyStreams, embyPollInterval);
    updateEmbyStreams();
</script>
